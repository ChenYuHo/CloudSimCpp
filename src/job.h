//
// Created by Chen-Yu Ho on 9/27/21.
//

#ifndef CLOUDSIMCPP_JOB_H
#define CLOUDSIMCPP_JOB_H

class Job {
private:
    static unsigned get_id() {
        static unsigned ID = 0;
        return ID++;
    }

public:
    unsigned id{};
    unsigned gpu{8};
    simtime_picosec submit_time{};
    simtime_picosec submitted_time{};
    simtime_picosec start_time{std::numeric_limits<simtime_picosec>::max()};
    simtime_picosec finish_time{std::numeric_limits<simtime_picosec>::max()};
    unsigned n_iter{3};
    unsigned num_workers_allocated{};
    std::set<unsigned> wids_allocated{};
    unsigned tensor_id{0};
    unsigned master_mid{};
    std::vector<uint64_t> model{};
    std::vector<uint64_t> forward_pass_time{};
    std::vector<uint64_t> backward_pass_time{};
//            100, 200, 300};//25393, 23232, 64, 307200, 192, 663552, 384, 884736, 256, 589824, 256, 37748736, 4096,
    //16777216, 4096, 4096000, 1000}; // number of parameter (gradient) elements per layer, default to AlexNet size

    explicit Job(simtime_picosec t, simcpp20::simulation<SIM_UNIT> &sim) : submit_time(t), id(get_id()) {
        myprintf("Job %d constructor invoked\n", this->id);
    }

    explicit Job(simtime_picosec t, simcpp20::simulation<SIM_UNIT> &sim,
                 std::vector<uint64_t> model) : submit_time(
            t), id(get_id()), model(std::move(model)) {
//        myprintf("Job %d constructor invoked\n", this->id);
    }

    Job(simtime_picosec t, simcpp20::simulation<SIM_UNIT> &sim,
        std::vector<uint64_t> model, unsigned iter, unsigned gpu) : gpu(gpu), submit_time(t), id(get_id()),
            n_iter(iter), model(std::move(model)) {}

    Job(simtime_picosec t, simcpp20::simulation<SIM_UNIT> &sim,
        const std::string &m, unsigned iter, unsigned gpu) : gpu(gpu), submit_time(t), id(get_id()),
                                                             n_iter(iter) {
        if (m == "alexnet") {
            model = vector<uint64_t>{23232, 64, 307200, 192, 663552, 384, 884736, 256, 589824, 256, 37748736, 4096,
                                     16777216, 4096, 4096000, 1000};
            // in picoseconds
            forward_pass_time = vector<uint64_t>{722944001, 76117332, 695978681, 59392000, 390826662, 482986679, 351914674, 31402667, 55637335, 8192000, 18773333, 300373329, 20821333, 147797329, 58026666, 61781332};
            backward_pass_time = vector<uint64_t>{1190570652, 239957333, 1459882736, 178858658, 2086912076, 973482666, 669695991, 60074667, 49152002, 25258668, 25258668, 494592011, 20138667, 257706660, 76117332, 63829333};
        } else if (m == "vgg11") {
            model = vector<uint64_t>{1728, 64, 73728, 128, 294912, 256, 589824, 256, 1179648, 512, 2359296, 512,
                                     2359296, 512, 2359296, 512, 102760448, 4096, 16777216, 4096, 4096000, 1000};
        } else if (m == "vgg16") {
            model = vector<uint64_t>{1728, 64, 36864, 64, 73728, 128, 147456, 128, 294912, 256, 589824, 256, 589824,
                                     256, 1179648, 512, 2359296, 512, 2359296, 512, 2359296, 512, 2359296, 512, 2359296,
                                     512, 102760448, 4096, 16777216, 4096, 4096000, 1000};
        } else if (m == "vgg19") {
            model = vector<uint64_t>{1792, 36928, 73856, 147584, 295168, 590080, 590080, 590080, 1180160, 2359808, 2359808, 2359808, 2359808, 2359808, 2359808, 2359808, 102764544, 16781312, 4097000};
            forward_pass_time = vector<uint64_t>{18444944500, 25643569500, 17102720000, 19151772000, 10508983000, 12346872500, 12353778000, 12357851000, 7110066000, 9792293000, 9781448500, 9782289000, 3776347500, 3125101500, 3125258500, 3124843500, 4152156500, 487340000, 293098500};
            backward_pass_time = vector<uint64_t>{61885338000, 46063523500, 47047047000, 23642434500, 22085069500, 22084641000, 22079324500, 14780634000, 17953074000, 17968546500, 17972460500, 8565622000, 6037035500, 6039702500, 6074416000, 3500557000, 4110283500, 797619500, 568407500};
        } else if (m == "inception3") {
            model = vector<uint64_t>{864, 64, 9216, 64, 18432, 128, 5120, 160, 138240, 384, 12288, 128, 9216, 96, 76800, 128, 12288, 128, 55296, 192, 82944, 192, 6144, 64, 16384, 128, 12288, 96, 76800, 128, 16384, 128, 55296, 192, 82944, 192, 16384, 128, 18432, 128, 13824, 96, 76800, 128, 18432, 128, 55296, 192, 82944, 192, 18432, 128, 995328, 768, 18432, 128, 55296, 192, 82944, 192, 147456, 384, 98304, 256, 114688, 256, 172032, 384, 98304, 256, 114688, 256, 114688, 256, 114688, 256, 172032, 384, 147456, 384, 147456, 384, 122880, 320, 179200, 320, 215040, 384, 122880, 320, 179200, 320, 179200, 320, 179200, 320, 215040, 384, 147456, 384, 147456, 384, 122880, 320, 179200, 320, 215040, 384, 122880, 320, 179200, 320, 179200, 320, 179200, 320, 215040, 384, 147456, 384, 147456, 384, 147456, 384, 258048, 384, 258048, 384, 147456, 384, 258048, 384, 258048, 384, 258048, 384, 258048, 384, 147456, 384, 147456, 384, 552960, 640, 147456, 384, 258048, 384, 258048, 384, 331776, 384, 409600, 640, 491520, 768, 442368, 768, 442368, 768, 573440, 896, 1548288, 768, 442368, 768, 442368, 768, 245760, 384, 655360, 640, 786432, 768, 442368, 768, 442368, 768, 917504, 896, 1548288, 768, 442368, 768, 442368, 768, 393216, 384, 2049000};
            forward_pass_time = vector<uint64_t>{854274000, 1956435000, 4199937500, 1632966500, 7020396000, 3486462000, 3944824500, 1013352500, 7513646000, 2936228500, 2471012000, 316099000, 439953000, 252546500, 1098680000, 311076000, 440077500, 312082500, 1025151000, 388119000, 1297247000, 389211000, 1537584500, 228257000, 912623500, 314561000, 524035500, 252423500, 1087122500, 310770000, 531023500, 313035500, 1010861500, 388168000, 1300024000, 389047500, 2208005500, 313048500, 1004920500, 314564500, 573708000, 251651000, 1084011000, 311031500, 566105500, 313096500, 1009708500, 392052500, 1303170500, 387146000, 2459292500, 314971500, 4974467000, 331161500, 568988000, 313653500, 1010886000, 391432500, 684166000, 173480500, 1488515500, 233246500, 679117000, 193181500, 614924500, 192045500, 732902500, 228411000, 677626500, 192761500, 558326000, 190180000, 589662000, 189646000, 561914500, 189266500, 747942500, 226676000, 2003670000, 230645500, 1107232500, 231656000, 845162500, 202737500, 765092000, 202146000, 836400000, 227517000, 845901500, 202641500, 733424000, 201356000, 767194500, 201325500, 739815500, 201958000, 857904500, 228081500, 2044187000, 229738000, 1107613000, 231500000, 846163000, 203070500, 765664500, 202123000, 837385000, 227126000, 846370500, 202735500, 733462000, 201707000, 767473000, 201069000, 740555000, 201078000, 857451500, 226678000, 2050239500, 229752000, 1107879000, 231702500, 848423500, 229414500, 1092809500, 230837500, 950412500, 228797000, 848800000, 229684500, 940690500, 228050500, 986202500, 227505000, 947482000, 227487000, 987847000, 227342000, 2053926500, 230346500, 1108102500, 231099500, 725569500, 154244000, 847564500, 229078500, 987424000, 228491500, 955607500, 227588000, 563777000, 146080000, 916916500, 155274000, 705741500, 157597000, 666536500, 156556500, 659075000, 156347500, 750500000, 163395500, 728924000, 157676000, 658756000, 156158000, 651295500, 155703500, 924088500, 147775000, 945542000, 153984500, 1024354000, 157504500, 662364000, 156207500, 655544500, 155753500, 1076302000, 163051000, 719439500, 157431500, 657842000, 155833000, 650539000, 155816000, 1379514000, 148425500, 616648000};
            backward_pass_time = vector<uint64_t>{1880218000, 4367083500, 10534975500, 4199671000, 14389864000, 14528905000, 2137404500, 2010050500, 20476991000, 10880829500, 1257419000, 746014000, 1182511500, 340873000, 2158700000, 747726500, 1260875500, 429203500, 2234385000, 551745500, 2759343500, 3357199500, 1122391000, 713714500, 1593831500, 854385500, 1471784500, 341523000, 2159327000, 855585000, 1587148500, 430301000, 2230856500, 553335000, 2757648500, 4285428000, 1595013500, 908803000, 1714019500, 910651500, 1599681000, 341488000, 2162979500, 910839500, 1715888000, 429034000, 2238246500, 554591500, 2757611500, 4746877500, 1709988500, 931475500, 12929684000, 1022912000, 1717007000, 432107500, 2283372500, 556062500, 1793423500, 2609187000, 2005349000, 619938500, 1341255500, 215789500, 1332166500, 216108000, 1688162500, 609038500, 1356760500, 214891500, 1299457000, 214706500, 1316070500, 214581000, 1326891000, 216018000, 1706313500, 3001650000, 1997623500, 620468000, 1998544000, 606414500, 1895787000, 242262500, 2006323500, 242615000, 2123710000, 607097000, 1899040000, 240855000, 2011457000, 242520000, 2001392000, 241835000, 2018844000, 244682500, 2121673000, 3003048000, 2000640500, 620812000, 2003260000, 620131500, 1897309500, 242461000, 2005872500, 242901000, 2127397000, 607792500, 1906474000, 241622500, 2012456000, 242271500, 2001382000, 241795000, 2020731500, 244988000, 2117150000, 3003080500, 1998631000, 621802000, 1998458000, 621855000, 1998374500, 323247500, 2422732000, 323467500, 2448184000, 615742500, 2000695000, 325235500, 2441473000, 323320000, 2413180500, 324726500, 2465166500, 314674000, 2433407000, 3001112000, 1998100000, 621957000, 1997525000, 323566500, 1547867000, 419850500, 2003782000, 325452000, 2429807500, 324099500, 2482452000, 313584500, 1085173500, 1644493500, 1206767500, 227894000, 1383475500, 160853500, 1172624500, 138880500, 1178752000, 250477500, 1609930500, 162896500, 1336920500, 161358000, 1166275000, 138161500, 1169945000, 1137734500, 856803500, 276643000, 1841628500, 305164500, 1991292000, 160305500, 1173192000, 139012000, 1177120500, 325210000, 2445155500, 163073500, 1340707500, 160847500, 1176848000, 139310000, 1189908500, 1735875500, 1225171000, 399738000, 759833000};
        } else if (m == "googlenet") {
            model = vector<uint64_t>{9408, 128, 4096, 128, 110592, 384, 12288, 128, 18432, 192, 110592, 256, 3072, 32, 4608, 64, 6144, 64, 32768, 256, 32768, 256, 221184, 384, 8192, 64, 27648, 192, 16384, 128, 92160, 384, 46080, 192, 179712, 416, 7680, 32, 6912, 96, 30720, 128, 81920, 320, 57344, 224, 225792, 448, 12288, 48, 13824, 128, 32768, 128, 65536, 256, 65536, 256, 294912, 512, 12288, 48, 13824, 128, 32768, 128, 57344, 224, 73728, 288, 373248, 576, 16384, 64, 18432, 128, 32768, 128, 135168, 512, 84480, 320, 460800, 640, 16896, 64, 36864, 256, 67584, 256, 212992, 512, 133120, 320, 460800, 640, 26624, 64, 36864, 256, 106496, 256, 319488, 768, 159744, 384, 663552, 768, 39936, 96, 55296, 256, 106496, 256, 1025000};
            forward_pass_time = vector<uint64_t>{2353193000, 1565072000, 2139501000, 480655000, 3573877000, 1222386500, 1600077500, 218579000, 534029500, 241626000, 864609500, 287774000, 295680500, 161802000, 262997500, 170492500, 1005742000, 173773500, 829095500, 290724500, 638634000, 288503000, 3247986500, 399977500, 356423500, 174042500, 518284500, 239231500, 1430107000, 215797500, 1488816000, 191561500, 360661000, 149936000, 533319000, 180822500, 244027000, 147595500, 206565500, 145600500, 714262500, 149533500, 559208000, 173648500, 392855500, 152472000, 563184500, 183994500, 248591000, 146740500, 202401500, 143953500, 750382500, 147932000, 454416000, 165057000, 391422000, 164314000, 741179500, 198008500, 256545500, 147669000, 204617000, 144947500, 750474000, 147970000, 459909000, 152722500, 534959500, 167674000, 864729000, 208089500, 258513500, 146523500, 214075000, 143607500, 753039500, 148158500, 720589000, 199737000, 506496500, 171713000, 1011901000, 211378000, 249664000, 146734000, 295571000, 164975500, 882534500, 164927500, 661541000, 150665500, 346542500, 146713500, 451958000, 148308500, 284429000, 145856000, 194487500, 142082500, 434928000, 146189500, 567609000, 156430000, 321459500, 146275000, 425008500, 152243500, 277979000, 143894000, 178249500, 139117500, 434386000, 146524500, 345499500};
            backward_pass_time = vector<uint64_t>{4234093000, 8103092000, 1252596500, 995197500, 9322637000, 6302594000, 886055000, 485485000, 1039762000, 364549000, 1914561000, 679118500, 533889000, 183103500, 693580500, 1388764500, 616361500, 464483000, 1235052500, 746947000, 1254416000, 480633000, 7528834500, 988775000, 918168000, 200368000, 1316959000, 1942091500, 1034923500, 2604925500, 972256000, 335402000, 676737000, 140023500, 1575061000, 347004500, 382873500, 101263000, 251319000, 882278000, 527487000, 241595000, 918419500, 304585500, 725217000, 144630500, 1005938500, 367606000, 410200500, 102222500, 295932000, 950046000, 543628500, 241735000, 770672500, 287674500, 779996000, 161829500, 1084427000, 394989000, 411183000, 102656000, 285181500, 948780500, 539715000, 241606500, 722253500, 268085000, 1057958500, 171862000, 3168670000, 416399500, 435278500, 106976500, 301748000, 950257500, 538193500, 247878000, 1456066000, 402916000, 1200500500, 181599000, 3470850000, 440378500, 451034500, 106402000, 539330500, 1019996500, 835232500, 1085689000, 625313500, 146496500, 515464500, 100612500, 673429500, 154022500, 267077000, 98120000, 318592500, 744064500, 416484000, 129850500, 863905500, 168961500, 553747000, 103116000, 719027500, 167018000, 365262500, 101036500, 370870500, 742569000, 432066000, 250797000, 590370000};
        } else if (m == "resnet101") {
            model = vector<uint64_t>{9408, 64, 64, 4096, 64, 64, 36864, 64, 64, 16384, 256, 256, 16384, 256, 256, 16384,
                                     64, 64, 36864, 64, 64, 16384, 256, 256, 16384, 64, 64, 36864, 64, 64, 16384, 256,
                                     256, 32768, 128, 128, 147456, 128, 128, 65536, 512, 512, 131072, 512, 512, 65536,
                                     128, 128, 147456, 128, 128, 65536, 512, 512, 65536, 128, 128, 147456, 128, 128,
                                     65536, 512, 512, 65536, 128, 128, 147456, 128, 128, 65536, 512, 512, 131072, 256,
                                     256, 589824, 256, 256, 262144, 1024, 1024, 524288, 1024, 1024, 262144, 256, 256,
                                     589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144,
                                     1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256,
                                     256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256,
                                     262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144,
                                     256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256,
                                     262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144,
                                     256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256,
                                     262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144,
                                     256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256,
                                     262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144,
                                     256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256,
                                     262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144,
                                     256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256,
                                     262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144,
                                     256, 256, 589824, 256, 256, 262144, 1024, 1024, 524288, 512, 512, 2359296, 512,
                                     512, 1048576, 2048, 2048, 2097152, 2048, 2048, 1048576, 512, 512, 2359296, 512,
                                     512, 1048576, 2048, 2048, 1048576, 512, 512, 2359296, 512, 512, 1048576, 2048,
                                     2048, 2048000, 1000};
        } else if (m == "resnet152") {
            model = vector<uint64_t>{9408, 64, 64, 4096, 64, 64, 36864, 64, 64, 16384, 256, 256, 16384, 256, 256, 16384,
                                     64, 64, 36864, 64, 64, 16384, 256, 256, 16384, 64, 64, 36864, 64, 64, 16384, 256,
                                     256, 32768, 128, 128, 147456, 128, 128, 65536, 512, 512, 131072, 512, 512, 65536,
                                     128, 128, 147456, 128, 128, 65536, 512, 512, 65536, 128, 128, 147456, 128, 128,
                                     65536, 512, 512, 65536, 128, 128, 147456, 128, 128, 65536, 512, 512, 65536, 128,
                                     128, 147456, 128, 128, 65536, 512, 512, 65536, 128, 128, 147456, 128, 128, 65536,
                                     512, 512, 65536, 128, 128, 147456, 128, 128, 65536, 512, 512, 65536, 128, 128,
                                     147456, 128, 128, 65536, 512, 512, 131072, 256, 256, 589824, 256, 256, 262144,
                                     1024, 1024, 524288, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024,
                                     1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256,
                                     589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144,
                                     1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256,
                                     256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256,
                                     262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144,
                                     256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256,
                                     262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144,
                                     256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256,
                                     262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144,
                                     256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256,
                                     262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144,
                                     256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256,
                                     262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144,
                                     256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256,
                                     262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144,
                                     256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256,
                                     262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144,
                                     256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256,
                                     262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144,
                                     256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256,
                                     262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144,
                                     256, 256, 589824, 256, 256, 262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256,
                                     262144, 1024, 1024, 262144, 256, 256, 589824, 256, 256, 262144, 1024, 1024, 524288,
                                     512, 512, 2359296, 512, 512, 1048576, 2048, 2048, 2097152, 2048, 2048, 1048576,
                                     512, 512, 2359296, 512, 512, 1048576, 2048, 2048, 1048576, 512, 512, 2359296, 512,
                                     512, 1048576, 2048, 2048, 2048000, 1000};
        } else { // resnet50
            model = vector<uint64_t>{9408, 128, 4096, 128, 36864, 128, 16384, 512, 16384, 512, 16384, 128, 36864, 128, 16384, 512, 16384, 128, 36864, 128, 16384, 512, 32768, 256, 147456, 256, 65536, 1024, 131072, 1024, 65536, 256, 147456, 256, 65536, 1024, 65536, 256, 147456, 256, 65536, 1024, 65536, 256, 147456, 256, 65536, 1024, 131072, 512, 589824, 512, 262144, 2048, 524288, 2048, 262144, 512, 589824, 512, 262144, 2048, 262144, 512, 589824, 512, 262144, 2048, 262144, 512, 589824, 512, 262144, 2048, 262144, 512, 589824, 512, 262144, 2048, 262144, 512, 589824, 512, 262144, 2048, 524288, 1024, 2359296, 1024, 1048576, 4096, 2097152, 4096, 1048576, 1024, 2359296, 1024, 1048576, 4096, 1048576, 1024, 2359296, 1024, 1048576, 4096, 2049000};
            forward_pass_time = vector<uint64_t>{2345217500, 1560477500, 2157324500, 476138000, 1435879000, 472562000, 1332181000, 1401587500, 1214179500, 1398264000, 2797879500, 473314000, 1418580500, 470377500, 1331429000, 1397622000, 2797083000, 472622500, 1418707000, 471020000, 1331315000, 1401653500, 3606144500, 766917000, 2460891000, 288108000, 1113927000, 785974000, 1876150500, 784770000, 1858716000, 286508500, 1054309500, 285016000, 1113480000, 784775000, 1858833500, 286889000, 1032144000, 284878500, 1110179000, 794344000, 1859064500, 286534000, 1033327500, 283657000, 1109914000, 782318000, 2575788000, 446762000, 2217989500, 205348000, 1015280500, 384291000, 1761761500, 380114500, 1404452000, 196131500, 976713000, 193597000, 1013826000, 382279000, 1404060000, 196153000, 971824000, 193798500, 1014049000, 382214000, 1403674500, 196033000, 971501000, 193982000, 1013507500, 381709000, 1403958000, 196260000, 972313500, 193319000, 1013049000, 381631000, 1404005500, 196304500, 972423500, 193855500, 1014273500, 380425000, 2312679500, 262821000, 2142014500, 166422500, 1079197500, 275141000, 1915578000, 271357500, 1158845500, 162902000, 999430500, 161766500, 1022185000, 273208000, 1157918000, 162388000, 976268500, 161219000, 1021963500, 275944000, 623475500};
            backward_pass_time = vector<uint64_t>{4226917000, 8357638500, 1239318500, 988933500, 4208404500, 993005500, 2862640500, 2259817500, 2872132000, 4438345500, 2930523000, 991802000, 4228487000, 987883000, 2873816000, 4439300000, 2940770500, 990942500, 4232802500, 989705500, 2864924500, 4441830500, 4317184000, 1727001000, 5643442500, 475413000, 2091644000, 1161134000, 4434470000, 2243324000, 2116825000, 478822000, 1986196000, 475886500, 2089054500, 2271258000, 2115799000, 477181000, 1990232500, 477445000, 2090853500, 2236442500, 2117140500, 478406000, 2008706500, 476958000, 2094891000, 2260278500, 3870402500, 901751500, 4728777000, 272447500, 2016171000, 629150000, 4350194500, 1151888000, 1988044500, 269933000, 1904678500, 272743000, 2013563500, 1153120500, 1987328500, 269334000, 1903700500, 272342500, 2014159500, 1153744000, 1987305000, 269643000, 1903814500, 272239500, 2011953000, 1157786500, 1987740500, 270184000, 1903966000, 271896000, 2015321000, 1151627000, 1990885000, 270105500, 1924061000, 272633000, 2007686500, 1159597000, 3716505500, 522115000, 5062010000, 154355500, 2119364000, 309421000, 5181126000, 566875000, 2153699500, 182544500, 1760146500, 154500500, 2118343500, 567212500, 2163179500, 182365500, 1781675000, 156924500, 2154465000, 657575500, 581784500};
        }
    }

//    simcpp20::event<SIM_UNIT> run(simcpp20::simulation<SIM_UNIT> &sim, const std::unordered_map<unsigned, unsigned> &run_config) {
//        start_time = sim.now();
//        co_await sim.timeout(10);
//        finish_time = sim.now();
//    }
};

//#include <climits>
//#include <utility>
//#include "eventlist.h"
//#include "config.h"
//#include "worker.h"
//
//class Cluster;
//
//class Job : public EventSource {
//private:
//    std::shared_ptr<Worker> _worker{};
//
//
//    static unsigned get_id() {
//        static unsigned ID = 0;
//        return ID++;
//    }
//
//    unsigned _id{};
//
//public:
////    std::shared_ptr<Cluster> cluster(){return _worker->cluster();};
//    unsigned id() { return _id; };
//    unsigned gpus_required{4};
//    unsigned n_iter{1};
//    unsigned num_workers_allocated{0};
//    simtime_picosec submit_time{ULLONG_MAX};
//    simtime_picosec start_time{ULLONG_MAX};
//    simtime_picosec finish_time{ULLONG_MAX};
//    std::vector<uint64_t> model{50, 150405871, 103492470, 9396470, 159038920, 46686320, 134762900, 4176430};
////            100, 200, 300};//25393, 23232, 64, 307200, 192, 663552, 384, 884736, 256, 589824, 256, 37748736, 4096,
//    //16777216, 4096, 4096000, 1000}; // number of parameter (gradient) elements per layer, default to AlexNet size
//
//    explicit Job(std::shared_ptr<Cluster> cluster, simtime_picosec t, EventList &ev) :
//            EventSource(ev, "job"),
//            submit_time(t),
//            _id(get_id()) {
//        myprintf("Job %d constructor invoked\n", this->_id);
//    }
//
//    explicit Job(std::shared_ptr<Cluster> cluster, simtime_picosec t, EventList &ev, std::vector<uint64_t> model) :
//            EventSource(ev, "job"),
//            submit_time(t),
//            _id(get_id()),
//            model(std::move(model)) {
//        myprintf("Job %d constructor invoked\n", this->_id);
//    }
//
//    void doNextEvent() override;
//};


#endif //CLOUDSIMCPP_JOB_H
